<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (13.0.2) on Wed Jul 26 17:31:24 EDT 2023 -->
<title>MLPhylogeny</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2023-07-26">
<meta name="description" content="declaration: module: count, package: count.model, class: MLPhylogeny">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../script-dir/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
<script type="text/javascript" src="../../../script-dir/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../script-dir/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../script-dir/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../script-dir/jquery-3.4.1.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-ui.js"></script>
</head>
<body class="class-declaration">
<script type="text/javascript">var data = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":42,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10,"i15":10,"i16":10,"i17":10,"i18":10,"i19":10,"i20":10,"i21":10,"i22":10,"i23":9,"i24":9,"i25":10,"i26":10,"i27":10,"i28":10,"i29":10,"i30":10,"i31":10,"i32":10,"i33":10,"i34":10,"i35":10,"i36":10,"i37":10,"i38":10,"i39":10,"i40":10,"i41":10,"i42":10,"i43":10,"i44":10,"i45":10,"i46":10,"i47":10,"i48":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"],32:["t6","Deprecated Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../module-summary.html">Module</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/MLPhylogeny.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<div class="navListSearch"><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</div>
</div>
<a id="skip.navbar.top">
<!--   -->
</a>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="moduleLabelInType">Module</span>&nbsp;<a href="../../module-summary.html">count</a></div>
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">count.model</a></div>
<h1 title="Class MLPhylogeny" class="title">Class MLPhylogeny</h1>
</div>
<div class="contentContainer">
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">java.lang.Object</a>
<div class="inheritance">count.model.MLPhylogeny</div>
</div>
<section class="description">
<hr>
<pre>public class <span class="typeNameLabel">MLPhylogeny</span>
extends <a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></pre>
<div class="block">Experimental code for phylogeny reconstruction from copy-number data.
 The optimization proceeds by considering subtree-prune-and-regraft (SPR) 
 operations as candidate <em>moves</em>, 
 defined by pairs of nodes for prune and regraft positions. 
 Candidate moves are first score heuristically, 
 and then with maximum-likelihood.  
  
 <p>The heuristic scoring is done using minimum parsimony
 by default. SPR moves are stored in a min-heap by heuristic score 
 with each prune node (<a href="#node_moves"><code>node_moves</code></a>). Top-scoring candidates from each prune position
 are scored with ML, and are stored in a min-heap (<a href="#model_moves"><code>model_moves</code></a>). In particular, the ML-score is 
 the difference in negative log-likelihood if the SPR move is made. 
 The best top move is accepted if the score is below a given threshold.   
 After an SPR move, the data structures are updated to include new SPR moves, and delete 
 those that are not possible anymore. The candidate moves that stay valid are rescored lazily 
 on the heaps, trying to avoid recalculation of all scores. 
 
  <ul>
 <li><a href="#buildModel(double)"><code>buildModel(double)</code></a> builds the phylogeny from scratch. It initializes a star phylogeny
 with infinitely long edges leading to the leaves from a single root. 
 Infinite edges encode a forest of finite-length phylogenies, each rooted at 
 an infinite edge. A completely resolved phylogeny contains (at most) one infinite edge 
 leading to the root (to define the root prior distribution for copy numbers). The starting model 
 may have one or more infinite-length edges. </li>
 
 <li><a href="#walkModel(double)"><code>walkModel(double)</code></a> makes a series of SPR moves, selecting the next move greedily until   
 no more moves are available with a score change below the threshold. </li>
 
 <li><a href="#placeRoot(double)"><code>placeRoot(double)</code></a> scores possible alternative rerootings descending from the root. </li>
 
 <li><a href="#contractEdges(double)"><code>contractEdges(double)</code></a> contracts edges that do not affect the model score much. </li>
 
 <li><a href="#pollardEdges(double)"><code>pollardEdges(double)</code></a> prunes high-loss edges, grafts them at the root, and recomputes
 model rates.</li>
 
 <li><a href="#main(java.lang.String%5B%5D)"><code>main(String[])</code></a> gives a command-line interface to launching topology exploration 
 with a standard model class (3 parameters per edge).  </li>
 
 </ul>
 
 <p>Possible topology transformations are stored as <a href="MLPhylogeny.CandidateMove.html" title="class in count.model"><code>MLPhylogeny.CandidateMove</code></a> instances. </p>
 
 <p><strong>Time complexity.</strong> ML-scoring of a model takes quadratic time 
 (times a constant depending on convergence settings) in the tree size. Initially, and 
 for every current phylogeny over <var>n</var> leaves, there are O(<var>n</var><sup>2</sup>)
 possible SPR moves (identified as pairs of prune and regraft nodes). 
 At every iteration of accepting a move, 
 O(<var>n</var>) SPR moves are created/destroyed; O(<var>t n</var>) are 
 scored or rescored heuristically, and 
 O(<var>t</var>) are scored with full ML, 
 where <var>t</var>=<a href="#top_scored_moves"><code>top_scored_moves</code></a> which can be set via 
 <a href="#setTopScoredMoves(int)"><code>setTopScoredMoves(int)</code></a>. 
 Heuristic scoring by parsimony
 (<a href="MLPhylogeny.CandidateMove.html#scoreParsimony(count.model.Parsimony.SPRExplorer)"><code>MLPhylogeny.CandidateMove.scoreParsimony(count.model.Parsimony.SPRExplorer)</code></a>)
 is O(<var>n</var>), 
 but by FastML (<a href="MLPhylogeny.CandidateMove.html#scoreFastML(int)"><code>MLPhylogeny.CandidateMove.scoreFastML(int)</code></a>), it is O(<var>n</var><sup>2</sup>).
 (The heuristic scoring is set with the flag <a href="#heuristic_byParsimony"><code>heuristic_byParsimony</code></a>.)   
 <a href="#buildModel(double)"><code>buildModel(double)</code></a> and <a href="#walkModel(double)"><code>walkModel(double)</code></a>   
 take O(<var>n</var>)
 iterations.
 Hence the total time is O(<var>t n</var><sup>3</sup>) 
 for heuristic scoring with parsimony, or 
 O(<var>t n</var><sup>4</sup>) for heuristic scoring with FastML.
 (The SPR update per iteration calls <a href="#recomputeWalkMoves()"><code>recomputeWalkMoves()</code></a> 
 which takes O(<var>n</var><sup>2</sup>) bc it enumerates all SPR moves, 
 but it scores heuristically only the O(<var>n</var>) newly created ones.)
 <a href="#placeRoot(double)"><code>placeRoot(double)</code></a>
 is O(<var>t n</var><sup>2</sup>); <a href="#pollardEdges(double)"><code>pollardEdges(double)</code></a> is O(<var>n</var><sup>2</sup>). 
 <a href="#contractEdges(double)"><code>contractEdges(double)</code></a> scores O(<var>n</var>) 
 contractions initially, and then at worst O(<var>n</var>) but typically O(1) 
 are rescored in each of O(<var>n</var>) iterations. Thus O(<var>n</var><sup>3</sup>) 
 for a sequence of contractions.  </p></div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>Mikl&oacute;s Cs&#369;r&ouml;s</dd>
</dl>
</section>
<section class="summary">
<ul class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li class="blockList">
<section class="nestedClassSummary"><a id="nested.class.summary">
<!--   -->
</a>
<h2>Nested Class Summary</h2>
<div class="memberSummary">
<table>
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<thead>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor">
<td class="colFirst"><code>private class&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="MLPhylogeny.CandidateHeuristics.html" title="class in count.model">MLPhylogeny.CandidateHeuristics</a></span></code></th>
<td class="colLast">
<div class="block">Heuristic scores stored for candidate moves.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private class&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="MLPhylogeny.CandidateMove.html" title="class in count.model">MLPhylogeny.CandidateMove</a></span></code></th>
<td class="colLast">
<div class="block">Candidate moves: SPR (join), edge contraction, and rerooting.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private class&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="MLPhylogeny.FastMLHeuristic.html" title="class in count.model">MLPhylogeny.FastMLHeuristic</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private class&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="MLPhylogeny.NearBestModels.html" title="class in count.model">MLPhylogeny.NearBestModels</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
</section>
</li>
<!-- =========== FIELD SUMMARY =========== -->
<li class="blockList">
<section class="fieldSummary"><a id="field.summary">
<!--   -->
</a>
<h2>Field Summary</h2>
<div class="memberSummary">
<table>
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<thead>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="../ds/Phylogeny.Node.html" title="class in count.ds">Phylogeny.Node</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#accepted_prune_moves">accepted_prune_moves</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="MLPhylogeny.CandidateMove.html" title="class in count.model">MLPhylogeny.CandidateMove</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#best_model">best_model</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#calculation_width_absolute">calculation_width_absolute</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private double</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#calculation_width_relative">calculation_width_relative</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#call_fLL">call_fLL</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#call_gradient">call_gradient</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#call_LL">call_LL</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#call_MP">call_MP</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#candidate_model_count">candidate_model_count</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#DEBUG_SCORE">DEBUG_SCORE</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#DEFAULT_CALCULATION_WIDTH_ABSOLUTE">DEFAULT_CALCULATION_WIDTH_ABSOLUTE</a></span></code></th>
<td class="colLast">
<div class="block">Absolute threshold for truncated computation.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static double</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#DEFAULT_CALCULATION_WIDTH_RELATIVE">DEFAULT_CALCULATION_WIDTH_RELATIVE</a></span></code></th>
<td class="colLast">
<div class="block">Relative threshold for truncated computation</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static double</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#DEFAULT_CONVERGENCE">DEFAULT_CONVERGENCE</a></span></code></th>
<td class="colLast">
<div class="block">Convergence (provides bound for gradient)</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static double</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#DEFAULT_PARSIMONY_DUPLICATION">DEFAULT_PARSIMONY_DUPLICATION</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static double</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#DEFAULT_PARSIMONY_GAIN">DEFAULT_PARSIMONY_GAIN</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static double</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#DEFAULT_PARSIMONY_LOSS">DEFAULT_PARSIMONY_LOSS</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#DEFAULT_ROUNDS">DEFAULT_ROUNDS</a></span></code></th>
<td class="colLast">
<div class="block">Max iterations for numerical optimization of distribution parameters</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#eager_node_moves">eager_node_moves</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#exclude_multiple_prune">exclude_multiple_prune</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#explore_nni">explore_nni</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#fit_parsimony">fit_parsimony</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#heuristic_byParsimony">heuristic_byParsimony</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/Double.html?is-external=true" title="class or interface in java.lang" class="externalLink">Double</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#history">history</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#min_copies">min_copies</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../ds/Heap.html" title="class in count.ds">Heap</a>&lt;<a href="MLPhylogeny.CandidateMove.html" title="class in count.model">MLPhylogeny.CandidateMove</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#model_moves">model_moves</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="MLPhylogeny.CandidateHeuristics.html" title="class in count.model">MLPhylogeny.CandidateHeuristics</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#move_heuristics">move_heuristics</a></span></code></th>
<td class="colLast">
<div class="block">Candidate moves with their heuristic score.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="MLPhylogeny.NearBestModels.html" title="class in count.model">MLPhylogeny.NearBestModels</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#near_best_models">near_best_models</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/Map.html?is-external=true" title="class or interface in java.util" class="externalLink">Map</a>&lt;<a href="../ds/Phylogeny.Node.html" title="class in count.ds">Phylogeny.Node</a>,&#8203;<a href="../ds/Heap.html" title="class in count.ds">Heap</a>&lt;<a href="MLPhylogeny.CandidateMove.html" title="class in count.model">MLPhylogeny.CandidateMove</a>&gt;&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#node_moves">node_moves</a></span></code></th>
<td class="colLast">
<div class="block">Candidate moves for each prune position; min-heaps ordered by heuristic score.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private double</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#opt_eps">opt_eps</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#opt_rounds">opt_rounds</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#optimize_EM">optimize_EM</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#optimize_rates">optimize_rates</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#PRINT_OPTIMIZATION_MESSAGES">PRINT_OPTIMIZATION_MESSAGES</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private double</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#pty_dup">pty_dup</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private double</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#pty_gain">pty_gain</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private double</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#pty_loss">pty_loss</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/Random.html?is-external=true" title="class or interface in java.util" class="externalLink">Random</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#RND">RND</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#scoring_byML">scoring_byML</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#session_id">session_id</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="Parsimony.SPRExplorer.html" title="class in count.model">Parsimony.SPRExplorer</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#spr_parsimony">spr_parsimony</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../ds/AnnotatedTable.html" title="class in count.ds">AnnotatedTable</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#table">table</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#time_fLL">time_fLL</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#time_gradient">time_gradient</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#time_LL">time_LL</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#TOP_MOVES">TOP_MOVES</a></span></code></th>
<td class="colLast">
<div class="block">Number of ML-scored models per node.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#top_scored_moves">top_scored_moves</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../ds/UniqueProfileTable.html" title="class in count.ds">UniqueProfileTable</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#utable">utable</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li class="blockList">
<section class="constructorSummary"><a id="constructor.summary">
<!--   -->
</a>
<h2>Constructor Summary</h2>
<div class="memberSummary">
<table>
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<thead>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(count.ds.AnnotatedTable)">MLPhylogeny</a></span>&#8203;(<a href="../ds/AnnotatedTable.html" title="class in count.ds">AnnotatedTable</a>&nbsp;table)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li class="blockList">
<section class="methodSummary"><a id="method.summary">
<!--   -->
</a>
<h2>Method Summary</h2>
<div class="memberSummary">
<div role="tablist" aria-orientation="horizontal"><button role="tab" aria-selected="true" aria-controls="memberSummary_tabpanel" tabindex="0" onkeydown="switchTab(event)" id="t0" class="activeTableTab">All Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t1" class="tableTab" onclick="show(1);">Static Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t2" class="tableTab" onclick="show(2);">Instance Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t4" class="tableTab" onclick="show(8);">Concrete Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t6" class="tableTab" onclick="show(32);">Deprecated Methods</button></div>
<div id="memberSummary_tabpanel" role="tabpanel">
<table aria-labelledby="t0">
<thead>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor" id="i0">
<td class="colFirst"><code>private <a href="../ds/Phylogeny.Node.html" title="class in count.ds">Phylogeny.Node</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#acceptJoinMove(count.model.MLPhylogeny.CandidateMove)">acceptJoinMove</a></span>&#8203;(<a href="MLPhylogeny.CandidateMove.html" title="class in count.model">MLPhylogeny.CandidateMove</a>&nbsp;alt_model)</code></th>
<td class="colLast">
<div class="block">Accepts a move and updates <a href="#best_model"><code>best_model</code></a> and 
 <a href="#spr_parsimony"><code>spr_parsimony</code></a> accordingly.</div>
</td>
</tr>
<tr class="rowColor" id="i1">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#addForestMoves(count.ds.Phylogeny.Node)">addForestMoves</a></span>&#8203;(<a href="../ds/Phylogeny.Node.html" title="class in count.ds">Phylogeny.Node</a>&nbsp;P)</code></th>
<td class="colLast">
<div class="block">Adds moves for initial model building.</div>
</td>
</tr>
<tr class="altColor" id="i2">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#addWalkMoves(count.ds.Phylogeny.Node)">addWalkMoves</a></span>&#8203;(<a href="../ds/Phylogeny.Node.html" title="class in count.ds">Phylogeny.Node</a>&nbsp;P)</code></th>
<td class="colLast">
<div class="block">Adds the moves for a node: either as prune node, or as regraft node; sets up 
 its entry in <a href="#node_moves"><code>node_moves</code></a></div>
</td>
</tr>
<tr class="rowColor" id="i3">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#buildModel(double)">buildModel</a></span>&#8203;(double&nbsp;refine_threshold)</code></th>
<td class="colLast">
<div class="block">Building a model: 
 
  <a href="#initModel(count.model.TreeWithRates)"><code>initModel(TreeWithRates)</code></a> sets up a forest for <a href="#best_model"><code>best_model</code></a> 
  <a href="#initBuildMoves()"><code>initBuildMoves()</code></a> adds all starting SPR moves
  <a href="#refineModel(double)"><code>refineModel(double)</code></a> iteration step for accepting one SPR at a time
 </div>
</td>
</tr>
<tr class="altColor" id="i4">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#contractEdges(double)">contractEdges</a></span>&#8203;(double&nbsp;contract_threshold)</code></th>
<td class="colLast">
<div class="block">Contracts edges in a greedy order for score change; 
 each step must change by at most the given contract threshold.</div>
</td>
</tr>
<tr class="rowColor" id="i5">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#debugScore(count.model.MLPhylogeny.CandidateMove,java.io.PrintStream,java.lang.String)">debugScore</a></span>&#8203;(<a href="MLPhylogeny.CandidateMove.html" title="class in count.model">MLPhylogeny.CandidateMove</a>&nbsp;M,
<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/io/PrintStream.html?is-external=true" title="class or interface in java.io" class="externalLink">PrintStream</a>&nbsp;out,
<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;reason)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i6">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#debugScore(java.io.PrintStream)">debugScore</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/io/PrintStream.html?is-external=true" title="class or interface in java.io" class="externalLink">PrintStream</a>&nbsp;out)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i7">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#deleteNodeMove(count.model.MLPhylogeny.CandidateMove)">deleteNodeMove</a></span>&#8203;(<a href="MLPhylogeny.CandidateMove.html" title="class in count.model">MLPhylogeny.CandidateMove</a>&nbsp;moot)</code></th>
<td class="colLast">
<div class="block">Removes a candidate move from <a href="#node_moves"><code>node_moves</code></a> and 
 <a href="#move_heuristics"><code>move_heuristics</code></a>.</div>
</td>
</tr>
<tr class="altColor" id="i8">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#exploreNNI(double)">exploreNNI</a></span>&#8203;(double&nbsp;increase_threshold)</code></th>
<td class="colLast">
<div class="block"><span class="deprecatedLabel">Deprecated.</span>&nbsp;</div>
</td>
</tr>
<tr class="rowColor" id="i9">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#fitParsimonyPenalties(count.model.TreeWithRates,count.ds.UniqueProfileTable)">fitParsimonyPenalties</a></span>&#8203;(<a href="TreeWithRates.html" title="class in count.model">TreeWithRates</a>&nbsp;model_rates,
<a href="../ds/UniqueProfileTable.html" title="class in count.ds">UniqueProfileTable</a>&nbsp;mapped_table)</code></th>
<td class="colLast">
<div class="block">Uses <a href="DirectEM.html#fitParsimonyPenalty()"><code>DirectEM.fitParsimonyPenalty()</code></a> to set penalties for parsimony.</div>
</td>
</tr>
<tr class="altColor" id="i10">
<td class="colFirst"><code>private <a href="MLPhylogeny.NearBestModels.html" title="class in count.model">MLPhylogeny.NearBestModels</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#fromBundle(count.io.ModelBundle)">fromBundle</a></span>&#8203;(<a href="../io/ModelBundle.html" title="class in count.io">ModelBundle</a>&nbsp;bundle)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i11">
<td class="colFirst"><code><a href="../ds/Phylogeny.html" title="class in count.ds">Phylogeny</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getPhylogeny()">getPhylogeny</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i12">
<td class="colFirst"><code><a href="TreeWithRates.html" title="class in count.model">TreeWithRates</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getRates()">getRates</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i13">
<td class="colFirst"><code><a href="GammaInvariant.html" title="class in count.model">GammaInvariant</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getRateVariation()">getRateVariation</a></span>()</code></th>
<td class="colLast">
<div class="block">Convenience method to wrap <a href="#getRates()"><code>getRates()</code></a> into 
 1 class.</div>
</td>
</tr>
<tr class="altColor" id="i14">
<td class="colFirst"><code>double</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getScore()">getScore</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i15">
<td class="colFirst"><code>private <a href="Parsimony.SPRExplorer.html" title="class in count.model">Parsimony.SPRExplorer</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getSPRExplorer()">getSPRExplorer</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i16">
<td class="colFirst"><code>private <a href="../ds/Heap.html" title="class in count.ds">Heap</a>&lt;<a href="MLPhylogeny.CandidateMove.html" title="class in count.model">MLPhylogeny.CandidateMove</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getTopNodeMoves(double,int)">getTopNodeMoves</a></span>&#8203;(double&nbsp;hscore_threshold,
int&nbsp;top_per_node)</code></th>
<td class="colLast">
<div class="block">Heap ordered by heuristic score from top moves at each node.</div>
</td>
</tr>
<tr class="rowColor" id="i17">
<td class="colFirst"><code>private double</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#improveModel(double)">improveModel</a></span>&#8203;(double&nbsp;improve_threshold)</code></th>
<td class="colLast">
<div class="block">One iteration for model walking:
    make the best SPR move and update the 
    set of possible node moves.</div>
</td>
</tr>
<tr class="altColor" id="i18">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#initBuildMoves()">initBuildMoves</a></span>()</code></th>
<td class="colLast">
<div class="block">Initialization and population of the data structures
 for model building.</div>
</td>
</tr>
<tr class="rowColor" id="i19">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#initModel(count.model.TreeWithRates)">initModel</a></span>&#8203;(<a href="TreeWithRates.html" title="class in count.model">TreeWithRates</a>&nbsp;rates)</code></th>
<td class="colLast">
<div class="block">Initializes the search or walk.</div>
</td>
</tr>
<tr class="altColor" id="i20">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#initWalkMoves()">initWalkMoves</a></span>()</code></th>
<td class="colLast">
<div class="block">Initialization and population of the data structures 
 for model walking.</div>
</td>
</tr>
<tr class="rowColor" id="i21">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#initWalkMoves(java.util.Set)">initWalkMoves</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;&nbsp;wanted_leaf_names)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i22">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#loadNearBestModels(java.lang.String)">loadNearBestModels</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;bundle_file)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i23">
<td class="colFirst"><code>static void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#main(java.lang.String%5B%5D)">main</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>[]&nbsp;args)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i24">
<td class="colFirst"><code>private static <a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/Map.html?is-external=true" title="class or interface in java.util" class="externalLink">Map</a>&lt;<a href="../ds/Phylogeny.Node.html" title="class in count.ds">Phylogeny.Node</a>,&#8203;double[]&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#modelRates(count.model.TreeWithRates)">modelRates</a></span>&#8203;(<a href="TreeWithRates.html" title="class in count.model">TreeWithRates</a>&nbsp;model)</code></th>
<td class="colLast">
<div class="block">Arranges rate parameters per edge in a double array.</div>
</td>
</tr>
<tr class="rowColor" id="i25">
<td class="colFirst"><code>private <a href="ML.html" title="class in count.model">ML</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#parameterOptimizer(count.model.TreeWithRates,count.ds.ProfileTable)">parameterOptimizer</a></span>&#8203;(<a href="TreeWithRates.html" title="class in count.model">TreeWithRates</a>&nbsp;rates,
<a href="../ds/ProfileTable.html" title="interface in count.ds">ProfileTable</a>&nbsp;table)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i26">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#placeNodes(double,java.util.Set)">placeNodes</a></span>&#8203;(double&nbsp;walk_threshold,
<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;&nbsp;wanted_leaf_names)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i27">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#placeRoot(double)">placeRoot</a></span>&#8203;(double&nbsp;refine_threshold)</code></th>
<td class="colLast">
<div class="block">Tries all rootings and picks the one with maximum likelihood.</div>
</td>
</tr>
<tr class="altColor" id="i28">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#pollardEdges(double)">pollardEdges</a></span>&#8203;(double&nbsp;loss_prob_threshold)</code></th>
<td class="colLast">
<div class="block">Prunes high-loss edges and regrafts them at the root.</div>
</td>
</tr>
<tr class="rowColor" id="i29">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#randomModel()">randomModel</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i30">
<td class="colFirst"><code>(package private) void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#recomputeWalkMoves()">recomputeWalkMoves</a></span>()</code></th>
<td class="colLast">
<div class="block">Enumerates all SPR moves and 
 resets candidate move structures; copying 
 the current scores for all moves that are still valid.</div>
</td>
</tr>
<tr class="rowColor" id="i31">
<td class="colFirst"><code>private double</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#refineModel(double)">refineModel</a></span>&#8203;(double&nbsp;max_score)</code></th>
<td class="colLast">
<div class="block">One iteration for model refinement with forest:
    make the best model move and update the 
    set of possible node moves after the SPR.</div>
</td>
</tr>
<tr class="altColor" id="i32">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#refreshNodeMove(count.model.MLPhylogeny.CandidateMove)">refreshNodeMove</a></span>&#8203;(<a href="MLPhylogeny.CandidateMove.html" title="class in count.model">MLPhylogeny.CandidateMove</a>&nbsp;move)</code></th>
<td class="colLast">
<div class="block">Refreshes the SPR phylogeny 
 when reference model changes, and the
 node moves heaps where this move appears.</div>
</td>
</tr>
<tr class="rowColor" id="i33">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#saveNearBestModels(java.lang.String,java.lang.String)">saveNearBestModels</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;bundle_file,
<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;bundle_id)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i34">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#searchModels(int,double)">searchModels</a></span>&#8203;(int&nbsp;max_unsuccessful,
double&nbsp;search_threshold)</code></th>
<td class="colLast">
<div class="block">Stochastic search in model space by perturbations (jumps)
 via random NNI sequences, followed by model walking.</div>
</td>
</tr>
<tr class="rowColor" id="i35">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setCalculationWidth(int,double)">setCalculationWidth</a></span>&#8203;(int&nbsp;absolute,
double&nbsp;relative)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i36">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setMinCopies(int)">setMinCopies</a></span>&#8203;(int&nbsp;min_copies)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i37">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setMLParameters(count.model.ML)">setMLParameters</a></span>&#8203;(<a href="ML.html" title="class in count.model">ML</a>&nbsp;M)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i38">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setOptimizationConvergence(int,double)">setOptimizationConvergence</a></span>&#8203;(int&nbsp;max_rounds,
double&nbsp;eps)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i39">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setOptimizationHistory(java.util.List)">setOptimizationHistory</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/Double.html?is-external=true" title="class or interface in java.lang" class="externalLink">Double</a>&gt;&nbsp;history)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i40">
<td class="colFirst"><code>(package private) void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setRandom(java.util.Random)">setRandom</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/Random.html?is-external=true" title="class or interface in java.util" class="externalLink">Random</a>&nbsp;RND)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i41">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#SetSession(java.lang.String)">SetSession</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;session_id)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i42">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setTopScoredMoves(int)">setTopScoredMoves</a></span>&#8203;(int&nbsp;ml_scored_models_per_node)</code></th>
<td class="colLast">
<div class="block">Sets the number of top (by heuristic scoring)
 models per node moves that are considered for <a href="#model_moves"><code>model_moves</code></a>.</div>
</td>
</tr>
<tr class="rowColor" id="i43">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#stochasticNNI(int)">stochasticNNI</a></span>&#8203;(int&nbsp;num_steps)</code></th>
<td class="colLast">
<div class="block">Makes a a number of random NNI moves</div>
</td>
</tr>
<tr class="altColor" id="i44">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#tourModel(int,double,double,double)">tourModel</a></span>&#8203;(int&nbsp;num_walks,
double&nbsp;walk_threshold,
double&nbsp;top_increase,
double&nbsp;convergence_decrease)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i45">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#updateModelMoves()">updateModelMoves</a></span>()</code></th>
<td class="colLast">
<div class="block">Adds and scores the top candidates for each node move.</div>
</td>
</tr>
<tr class="altColor" id="i46">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#updateModelMoves(double)">updateModelMoves</a></span>&#8203;(double&nbsp;hscore_threshold)</code></th>
<td class="colLast">
<div class="block">Adds and scores the top candidates for each node.</div>
</td>
</tr>
<tr class="rowColor" id="i47">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#upgmaModel()">upgmaModel</a></span>()</code></th>
<td class="colLast">
<div class="block">Builds a starting tree using UPGMA, and optimizes the model parameters.</div>
</td>
</tr>
<tr class="altColor" id="i48">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#walkModel(double)">walkModel</a></span>&#8203;(double&nbsp;walk_threshold)</code></th>
<td class="colLast">
<div class="block">Improves the model by SPR moves.</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="inheritedList">
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></h3>
<a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a><code><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang" class="externalLink">clone</a>, <a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang" class="externalLink">equals</a>, <a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang" class="externalLink">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang" class="externalLink">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang" class="externalLink">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang" class="externalLink">notify</a>, <a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang" class="externalLink">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang" class="externalLink">toString</a>, <a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/Object.html?is-external=true#wait(long,int)" title="class or interface in java.lang" class="externalLink">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<li class="blockList">
<section class="fieldDetails"><a id="field.detail">
<!--   -->
</a>
<h2>Field Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="PRINT_OPTIMIZATION_MESSAGES">PRINT_OPTIMIZATION_MESSAGES</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">PRINT_OPTIMIZATION_MESSAGES</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="DEBUG_SCORE">DEBUG_SCORE</a></h3>
<div class="memberSignature"><span class="modifiers">private static final</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">DEBUG_SCORE</span></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#count.model.MLPhylogeny.DEBUG_SCORE">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="DEFAULT_CALCULATION_WIDTH_ABSOLUTE">DEFAULT_CALCULATION_WIDTH_ABSOLUTE</a></h3>
<div class="memberSignature"><span class="modifiers">private static final</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">DEFAULT_CALCULATION_WIDTH_ABSOLUTE</span></div>
<div class="block">Absolute threshold for truncated computation.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#count.model.MLPhylogeny.DEFAULT_CALCULATION_WIDTH_ABSOLUTE">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="DEFAULT_CALCULATION_WIDTH_RELATIVE">DEFAULT_CALCULATION_WIDTH_RELATIVE</a></h3>
<div class="memberSignature"><span class="modifiers">private static final</span>&nbsp;<span class="returnType">double</span>&nbsp;<span class="memberName">DEFAULT_CALCULATION_WIDTH_RELATIVE</span></div>
<div class="block">Relative threshold for truncated computation</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#count.model.MLPhylogeny.DEFAULT_CALCULATION_WIDTH_RELATIVE">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="DEFAULT_ROUNDS">DEFAULT_ROUNDS</a></h3>
<div class="memberSignature"><span class="modifiers">private static final</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">DEFAULT_ROUNDS</span></div>
<div class="block">Max iterations for numerical optimization of distribution parameters</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#count.model.MLPhylogeny.DEFAULT_ROUNDS">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="DEFAULT_CONVERGENCE">DEFAULT_CONVERGENCE</a></h3>
<div class="memberSignature"><span class="modifiers">private static final</span>&nbsp;<span class="returnType">double</span>&nbsp;<span class="memberName">DEFAULT_CONVERGENCE</span></div>
<div class="block">Convergence (provides bound for gradient)</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#count.model.MLPhylogeny.DEFAULT_CONVERGENCE">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="TOP_MOVES">TOP_MOVES</a></h3>
<div class="memberSignature"><span class="modifiers">private static final</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">TOP_MOVES</span></div>
<div class="block">Number of ML-scored models per node.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#count.model.MLPhylogeny.TOP_MOVES">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="table">table</a></h3>
<div class="memberSignature"><span class="modifiers">private final</span>&nbsp;<span class="returnType"><a href="../ds/AnnotatedTable.html" title="class in count.ds">AnnotatedTable</a></span>&nbsp;<span class="memberName">table</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="utable">utable</a></h3>
<div class="memberSignature"><span class="modifiers">private final</span>&nbsp;<span class="returnType"><a href="../ds/UniqueProfileTable.html" title="class in count.ds">UniqueProfileTable</a></span>&nbsp;<span class="memberName">utable</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="calculation_width_absolute">calculation_width_absolute</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">calculation_width_absolute</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="calculation_width_relative">calculation_width_relative</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">double</span>&nbsp;<span class="memberName">calculation_width_relative</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="opt_rounds">opt_rounds</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">opt_rounds</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="opt_eps">opt_eps</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">double</span>&nbsp;<span class="memberName">opt_eps</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="min_copies">min_copies</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">min_copies</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="eager_node_moves">eager_node_moves</a></h3>
<div class="memberSignature"><span class="modifiers">private final</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">eager_node_moves</span></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#count.model.MLPhylogeny.eager_node_moves">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="explore_nni">explore_nni</a></h3>
<div class="memberSignature"><span class="modifiers">private final</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">explore_nni</span></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#count.model.MLPhylogeny.explore_nni">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="exclude_multiple_prune">exclude_multiple_prune</a></h3>
<div class="memberSignature"><span class="modifiers">private final</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">exclude_multiple_prune</span></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#count.model.MLPhylogeny.exclude_multiple_prune">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="RND">RND</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType"><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/Random.html?is-external=true" title="class or interface in java.util" class="externalLink">Random</a></span>&nbsp;<span class="memberName">RND</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="session_id">session_id</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType"><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a></span>&nbsp;<span class="memberName">session_id</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="best_model">best_model</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType"><a href="MLPhylogeny.CandidateMove.html" title="class in count.model">MLPhylogeny.CandidateMove</a></span>&nbsp;<span class="memberName">best_model</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="model_moves">model_moves</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType"><a href="../ds/Heap.html" title="class in count.ds">Heap</a>&lt;<a href="MLPhylogeny.CandidateMove.html" title="class in count.model">MLPhylogeny.CandidateMove</a>&gt;</span>&nbsp;<span class="memberName">model_moves</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="near_best_models">near_best_models</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType"><a href="MLPhylogeny.NearBestModels.html" title="class in count.model">MLPhylogeny.NearBestModels</a></span>&nbsp;<span class="memberName">near_best_models</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="node_moves">node_moves</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType"><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/Map.html?is-external=true" title="class or interface in java.util" class="externalLink">Map</a>&lt;<a href="../ds/Phylogeny.Node.html" title="class in count.ds">Phylogeny.Node</a>,&#8203;<a href="../ds/Heap.html" title="class in count.ds">Heap</a>&lt;<a href="MLPhylogeny.CandidateMove.html" title="class in count.model">MLPhylogeny.CandidateMove</a>&gt;&gt;</span>&nbsp;<span class="memberName">node_moves</span></div>
<div class="block">Candidate moves for each prune position; min-heaps ordered by heuristic score.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="move_heuristics">move_heuristics</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType"><a href="MLPhylogeny.CandidateHeuristics.html" title="class in count.model">MLPhylogeny.CandidateHeuristics</a></span>&nbsp;<span class="memberName">move_heuristics</span></div>
<div class="block">Candidate moves with their heuristic score.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="history">history</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType"><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/Double.html?is-external=true" title="class or interface in java.lang" class="externalLink">Double</a>&gt;</span>&nbsp;<span class="memberName">history</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="accepted_prune_moves">accepted_prune_moves</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType"><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="../ds/Phylogeny.Node.html" title="class in count.ds">Phylogeny.Node</a>&gt;</span>&nbsp;<span class="memberName">accepted_prune_moves</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="spr_parsimony">spr_parsimony</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType"><a href="Parsimony.SPRExplorer.html" title="class in count.model">Parsimony.SPRExplorer</a></span>&nbsp;<span class="memberName">spr_parsimony</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="top_scored_moves">top_scored_moves</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">top_scored_moves</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="optimize_EM">optimize_EM</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">optimize_EM</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="optimize_rates">optimize_rates</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">optimize_rates</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="scoring_byML">scoring_byML</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">scoring_byML</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="heuristic_byParsimony">heuristic_byParsimony</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">heuristic_byParsimony</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="fit_parsimony">fit_parsimony</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">fit_parsimony</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="candidate_model_count">candidate_model_count</a></h3>
<div class="memberSignature"><span class="modifiers">private static</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">candidate_model_count</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="DEFAULT_PARSIMONY_GAIN">DEFAULT_PARSIMONY_GAIN</a></h3>
<div class="memberSignature"><span class="modifiers">private static final</span>&nbsp;<span class="returnType">double</span>&nbsp;<span class="memberName">DEFAULT_PARSIMONY_GAIN</span></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#count.model.MLPhylogeny.DEFAULT_PARSIMONY_GAIN">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="DEFAULT_PARSIMONY_LOSS">DEFAULT_PARSIMONY_LOSS</a></h3>
<div class="memberSignature"><span class="modifiers">private static final</span>&nbsp;<span class="returnType">double</span>&nbsp;<span class="memberName">DEFAULT_PARSIMONY_LOSS</span></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#count.model.MLPhylogeny.DEFAULT_PARSIMONY_LOSS">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="DEFAULT_PARSIMONY_DUPLICATION">DEFAULT_PARSIMONY_DUPLICATION</a></h3>
<div class="memberSignature"><span class="modifiers">private static final</span>&nbsp;<span class="returnType">double</span>&nbsp;<span class="memberName">DEFAULT_PARSIMONY_DUPLICATION</span></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#count.model.MLPhylogeny.DEFAULT_PARSIMONY_DUPLICATION">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="pty_gain">pty_gain</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">double</span>&nbsp;<span class="memberName">pty_gain</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="pty_loss">pty_loss</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">double</span>&nbsp;<span class="memberName">pty_loss</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="pty_dup">pty_dup</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">double</span>&nbsp;<span class="memberName">pty_dup</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="time_LL">time_LL</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">long</span>&nbsp;<span class="memberName">time_LL</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="call_LL">call_LL</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">call_LL</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="call_fLL">call_fLL</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">call_fLL</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="time_fLL">time_fLL</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">long</span>&nbsp;<span class="memberName">time_fLL</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="call_MP">call_MP</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">call_MP</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="time_gradient">time_gradient</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">long</span>&nbsp;<span class="memberName">time_gradient</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="call_gradient">call_gradient</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">call_gradient</span></div>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li class="blockList">
<section class="constructorDetails"><a id="constructor.detail">
<!--   -->
</a>
<h2>Constructor Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="&lt;init&gt;(count.ds.AnnotatedTable)">MLPhylogeny</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="memberName">MLPhylogeny</span>&#8203;(<span class="arguments"><a href="../ds/AnnotatedTable.html" title="class in count.ds">AnnotatedTable</a>&nbsp;table)</span></div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li class="blockList">
<section class="methodDetails"><a id="method.detail">
<!--   -->
</a>
<h2>Method Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="setRandom(java.util.Random)">setRandom</a></h3>
<div class="memberSignature"><span class="modifiers">final</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">setRandom</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/Random.html?is-external=true" title="class or interface in java.util" class="externalLink">Random</a>&nbsp;RND)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="SetSession(java.lang.String)">SetSession</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">SetSession</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;session_id)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="setCalculationWidth(int,double)">setCalculationWidth</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">setCalculationWidth</span>&#8203;(<span class="arguments">int&nbsp;absolute,
double&nbsp;relative)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="setOptimizationConvergence(int,double)">setOptimizationConvergence</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">setOptimizationConvergence</span>&#8203;(<span class="arguments">int&nbsp;max_rounds,
double&nbsp;eps)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="setMinCopies(int)">setMinCopies</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">setMinCopies</span>&#8203;(<span class="arguments">int&nbsp;min_copies)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="setOptimizationHistory(java.util.List)">setOptimizationHistory</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">setOptimizationHistory</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/Double.html?is-external=true" title="class or interface in java.lang" class="externalLink">Double</a>&gt;&nbsp;history)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getRates()">getRates</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="TreeWithRates.html" title="class in count.model">TreeWithRates</a></span>&nbsp;<span class="memberName">getRates</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getRateVariation()">getRateVariation</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="GammaInvariant.html" title="class in count.model">GammaInvariant</a></span>&nbsp;<span class="memberName">getRateVariation</span>()</div>
<div class="block">Convenience method to wrap <a href="#getRates()"><code>getRates()</code></a> into 
 1 class.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the rate model as GammaInvariant</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getPhylogeny()">getPhylogeny</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../ds/Phylogeny.html" title="class in count.ds">Phylogeny</a></span>&nbsp;<span class="memberName">getPhylogeny</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getScore()">getScore</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">double</span>&nbsp;<span class="memberName">getScore</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="randomModel()">randomModel</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">randomModel</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="upgmaModel()">upgmaModel</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">upgmaModel</span>()</div>
<div class="block">Builds a starting tree using UPGMA, and optimizes the model parameters.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="buildModel(double)">buildModel</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">buildModel</span>&#8203;(<span class="arguments">double&nbsp;refine_threshold)</span></div>
<div class="block">Building a model: 
 <ol>
 <li> <a href="#initModel(count.model.TreeWithRates)"><code>initModel(TreeWithRates)</code></a> sets up a forest for <a href="#best_model"><code>best_model</code></a> </li>
 <li> <a href="#initBuildMoves()"><code>initBuildMoves()</code></a> adds all starting SPR moves</li>
 <li> <a href="#refineModel(double)"><code>refineModel(double)</code></a> iteration step for accepting one SPR at a time</li>
 </ol></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>refine_threshold</code> - maximum score change at a refinement step</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="tourModel(int,double,double,double)">tourModel</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">tourModel</span>&#8203;(<span class="arguments">int&nbsp;num_walks,
double&nbsp;walk_threshold,
double&nbsp;top_increase,
double&nbsp;convergence_decrease)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="searchModels(int,double)">searchModels</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">searchModels</span>&#8203;(<span class="arguments">int&nbsp;max_unsuccessful,
double&nbsp;search_threshold)</span></div>
<div class="block">Stochastic search in model space by perturbations (jumps)
 via random NNI sequences, followed by model walking.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>max_unsuccessful</code> - </dd>
<dd><code>search_threshold</code> - </dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="walkModel(double)">walkModel</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">walkModel</span>&#8203;(<span class="arguments">double&nbsp;walk_threshold)</span></div>
<div class="block">Improves the model by SPR moves. 
 Call when <a href="#best_model"><code>best_model</code></a> is set, after <a href="#initModel(count.model.TreeWithRates)"><code>initModel(TreeWithRates)</code></a>
 or <a href="#buildModel(double)"><code>buildModel(double)</code></a>.  
 
 Improving a model: 
 <ol>
 <li> <a href="#initWalkMoves()"><code>initWalkMoves()</code></a> adds all starting SPR moves </li>
 <li> <a href="#improveModel(double)"><code>improveModel(double)</code></a> iteration step for accepting one SPR move at a time</li>
 </ol></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>walk_threshold</code> - max accepted score change (exclusive bound)</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="placeNodes(double,java.util.Set)">placeNodes</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">placeNodes</span>&#8203;(<span class="arguments">double&nbsp;walk_threshold,
<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;&nbsp;wanted_leaf_names)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="placeRoot(double)">placeRoot</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">placeRoot</span>&#8203;(<span class="arguments">double&nbsp;refine_threshold)</span></div>
<div class="block">Tries all rootings and picks the one with maximum likelihood.
 Root placements are considered in the order of distance from 
 original root, trying up to <a href="#top_scored_moves"><code>top_scored_moves</code></a> choices. 
 The best root placement is accepted if its score is below the 
 refinement threshold.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>refine_threshold</code> - maximum score change (exclusive bound)</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="contractEdges(double)">contractEdges</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">contractEdges</span>&#8203;(<span class="arguments">double&nbsp;contract_threshold)</span></div>
<div class="block">Contracts edges in a greedy order for score change; 
 each step must change by at most the given contract threshold. 
 For instance, choosing 3/2*log(F) for F families 
 optimizes scoring by Bayesian Information Criterion
 with 3 parameters per edge. Note that with positive threshold, the 
 model score (negative log-likelihood) may increase, so follow with 
 <a href="#walkModel(double)"><code>walkModel(double)</code></a>. 

 UNTESTED</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>contract_threshold</code> - maximum score change allowed</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="pollardEdges(double)">pollardEdges</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">pollardEdges</span>&#8203;(<span class="arguments">double&nbsp;loss_prob_threshold)</span></div>
<div class="block">Prunes high-loss edges and regrafts them at the root.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>loss_prob_threshold</code> - (exclusive) lower threshold on loss probability for pruning edges</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getSPRExplorer()">getSPRExplorer</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType"><a href="Parsimony.SPRExplorer.html" title="class in count.model">Parsimony.SPRExplorer</a></span>&nbsp;<span class="memberName">getSPRExplorer</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="initModel(count.model.TreeWithRates)">initModel</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">initModel</span>&#8203;(<span class="arguments"><a href="TreeWithRates.html" title="class in count.model">TreeWithRates</a>&nbsp;rates)</span></div>
<div class="block">Initializes the search or walk.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>rates</code> - if null, constructs the starting model with a star phylogeny (=forest of single-leaf trees)</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="initBuildMoves()">initBuildMoves</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">initBuildMoves</span>()</div>
<div class="block">Initialization and population of the data structures
 for model building. SPR moves are between leaf pairs.
 
 <ol>
 <li> <a href="#addForestMoves(count.ds.Phylogeny.Node)"><code>addForestMoves(Node)</code></a> iteration step for adding the SPR moves with a leaf </li>
 <li> <a href="#updateModelMoves()"><code>updateModelMoves()</code></a> called once at the end to advance the best node moves to <a href="#model_moves"><code>model_moves</code></a></li>
 </ol></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="initWalkMoves()">initWalkMoves</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">initWalkMoves</span>()</div>
<div class="block">Initialization and population of the data structures 
 for model walking.
 <ol>
 <li> <a href="#addWalkMoves(count.ds.Phylogeny.Node)"><code>addWalkMoves(Node)</code></a> iteration step for adding the SPR moves with a node</li>
 <li> <a href="#updateModelMoves()"><code>updateModelMoves()</code></a> called once at the end to advance the best node moves to <a href="#model_moves"><code>model_moves</code></a></li>
 </ol></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="initWalkMoves(java.util.Set)">initWalkMoves</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">initWalkMoves</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/Set.html?is-external=true" title="class or interface in java.util" class="externalLink">Set</a>&lt;<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;&nbsp;wanted_leaf_names)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="setTopScoredMoves(int)">setTopScoredMoves</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">setTopScoredMoves</span>&#8203;(<span class="arguments">int&nbsp;ml_scored_models_per_node)</span></div>
<div class="block">Sets the number of top (by heuristic scoring)
 models per node moves that are considered for <a href="#model_moves"><code>model_moves</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ml_scored_models_per_node</code> - number of moves scored heuristically at a node</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="acceptJoinMove(count.model.MLPhylogeny.CandidateMove)">acceptJoinMove</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType"><a href="../ds/Phylogeny.Node.html" title="class in count.ds">Phylogeny.Node</a></span>&nbsp;<span class="memberName">acceptJoinMove</span>&#8203;(<span class="arguments"><a href="MLPhylogeny.CandidateMove.html" title="class in count.model">MLPhylogeny.CandidateMove</a>&nbsp;alt_model)</span></div>
<div class="block">Accepts a move and updates <a href="#best_model"><code>best_model</code></a> and 
 <a href="#spr_parsimony"><code>spr_parsimony</code></a> accordingly.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>alt_model</code> - </dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the newly created node: joint parent of the regraft an prune nodes</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="refineModel(double)">refineModel</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">double</span>&nbsp;<span class="memberName">refineModel</span>&#8203;(<span class="arguments">double&nbsp;max_score)</span></div>
<div class="block">One iteration for model refinement with forest:
    make the best model move and update the 
    set of possible node moves after the SPR.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>max_score</code> - max accepted move score</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>0.0 if no good move, &ge; max_score if only bad models, &lt; max_score if successful</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="refreshNodeMove(count.model.MLPhylogeny.CandidateMove)">refreshNodeMove</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">refreshNodeMove</span>&#8203;(<span class="arguments"><a href="MLPhylogeny.CandidateMove.html" title="class in count.model">MLPhylogeny.CandidateMove</a>&nbsp;move)</span></div>
<div class="block">Refreshes the SPR phylogeny 
 when reference model changes, and the
 node moves heaps where this move appears.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>move</code> - </dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="deleteNodeMove(count.model.MLPhylogeny.CandidateMove)">deleteNodeMove</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">deleteNodeMove</span>&#8203;(<span class="arguments"><a href="MLPhylogeny.CandidateMove.html" title="class in count.model">MLPhylogeny.CandidateMove</a>&nbsp;moot)</span></div>
<div class="block">Removes a candidate move from <a href="#node_moves"><code>node_moves</code></a> and 
 <a href="#move_heuristics"><code>move_heuristics</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>moot</code> - </dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="improveModel(double)">improveModel</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">double</span>&nbsp;<span class="memberName">improveModel</span>&#8203;(<span class="arguments">double&nbsp;improve_threshold)</span></div>
<div class="block">One iteration for model walking:
    make the best SPR move and update the 
    set of possible node moves.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>improve_threshold</code> - max accepted move score</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>0.0 if no good move, &ge; max_score if only bad models, &lt; max_score if successful</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="addForestMoves(count.ds.Phylogeny.Node)">addForestMoves</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">addForestMoves</span>&#8203;(<span class="arguments"><a href="../ds/Phylogeny.Node.html" title="class in count.ds">Phylogeny.Node</a>&nbsp;P)</span></div>
<div class="block">Adds moves for initial model building.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>P</code> - new node that is the parent of a prune-regraft join pair.</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="addWalkMoves(count.ds.Phylogeny.Node)">addWalkMoves</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">addWalkMoves</span>&#8203;(<span class="arguments"><a href="../ds/Phylogeny.Node.html" title="class in count.ds">Phylogeny.Node</a>&nbsp;P)</span></div>
<div class="block">Adds the moves for a node: either as prune node, or as regraft node; sets up 
 its entry in <a href="#node_moves"><code>node_moves</code></a></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>P</code> - </dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="recomputeWalkMoves()">recomputeWalkMoves</a></h3>
<div class="memberSignature"><span class="returnType">void</span>&nbsp;<span class="memberName">recomputeWalkMoves</span>()</div>
<div class="block">Enumerates all SPR moves and 
 resets candidate move structures; copying 
 the current scores for all moves that are still valid.  
 Sets <a href="#node_moves"><code>node_moves</code></a>, <a href="#model_moves"><code>model_moves</code></a> and <a href="#move_heuristics"><code>move_heuristics</code></a>.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getTopNodeMoves(double,int)">getTopNodeMoves</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType"><a href="../ds/Heap.html" title="class in count.ds">Heap</a>&lt;<a href="MLPhylogeny.CandidateMove.html" title="class in count.model">MLPhylogeny.CandidateMove</a>&gt;</span>&nbsp;<span class="memberName">getTopNodeMoves</span>&#8203;(<span class="arguments">double&nbsp;hscore_threshold,
int&nbsp;top_per_node)</span></div>
<div class="block">Heap ordered by heuristic score from top moves at each node.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>hscore_threshold</code> - </dd>
<dd><code>top_per_node</code> - </dd>
<dt><span class="returnLabel">Returns:</span></dt>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="updateModelMoves()">updateModelMoves</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">updateModelMoves</span>()</div>
<div class="block">Adds and scores the top candidates for each node move.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="updateModelMoves(double)">updateModelMoves</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">updateModelMoves</span>&#8203;(<span class="arguments">double&nbsp;hscore_threshold)</span></div>
<div class="block">Adds and scores the top candidates for each node. 
 Going through movable nodes with entry in <a href="#node_moves"><code>node_moves</code></a>, 
 adds at most <a href="#top_scored_moves"><code>top_scored_moves</code></a> best (by heuristic score) 
 from each to grow a collection 
 of top moves to consider, while purging out the invalid joins encountered. 
 At most twice <a href="#top_scored_moves"><code>top_scored_moves</code></a> top moves are added to 
 <a href="#model_moves"><code>model_moves</code></a>, and scored properly.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>hscore_threshold</code> - </dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="stochasticNNI(int)">stochasticNNI</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">stochasticNNI</span>&#8203;(<span class="arguments">int&nbsp;num_steps)</span></div>
<div class="block">Makes a a number of random NNI moves</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>num_steps</code> - </dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="exploreNNI(double)">exploreNNI</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">exploreNNI</span>&#8203;(<span class="arguments">double&nbsp;increase_threshold)</span></div>
<div class="deprecationBlock"><span class="deprecatedLabel">Deprecated.</span></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>increase_threshold</code> - </dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="modelRates(count.model.TreeWithRates)">modelRates</a></h3>
<div class="memberSignature"><span class="modifiers">private static</span>&nbsp;<span class="returnType"><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/Map.html?is-external=true" title="class or interface in java.util" class="externalLink">Map</a>&lt;<a href="../ds/Phylogeny.Node.html" title="class in count.ds">Phylogeny.Node</a>,&#8203;double[]&gt;</span>&nbsp;<span class="memberName">modelRates</span>&#8203;(<span class="arguments"><a href="TreeWithRates.html" title="class in count.model">TreeWithRates</a>&nbsp;model)</span></div>
<div class="block">Arranges rate parameters per edge in a double array.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>model</code> - </dd>
<dt><span class="returnLabel">Returns:</span></dt>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="setMLParameters(count.model.ML)">setMLParameters</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">setMLParameters</span>&#8203;(<span class="arguments"><a href="ML.html" title="class in count.model">ML</a>&nbsp;M)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="parameterOptimizer(count.model.TreeWithRates,count.ds.ProfileTable)">parameterOptimizer</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType"><a href="ML.html" title="class in count.model">ML</a></span>&nbsp;<span class="memberName">parameterOptimizer</span>&#8203;(<span class="arguments"><a href="TreeWithRates.html" title="class in count.model">TreeWithRates</a>&nbsp;rates,
<a href="../ds/ProfileTable.html" title="interface in count.ds">ProfileTable</a>&nbsp;table)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="fitParsimonyPenalties(count.model.TreeWithRates,count.ds.UniqueProfileTable)">fitParsimonyPenalties</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">fitParsimonyPenalties</span>&#8203;(<span class="arguments"><a href="TreeWithRates.html" title="class in count.model">TreeWithRates</a>&nbsp;model_rates,
<a href="../ds/UniqueProfileTable.html" title="class in count.ds">UniqueProfileTable</a>&nbsp;mapped_table)</span></div>
<div class="block">Uses <a href="DirectEM.html#fitParsimonyPenalty()"><code>DirectEM.fitParsimonyPenalty()</code></a> to set penalties for parsimony.
 Nothing happens if <a href="#optimize_EM"><code>optimize_EM</code></a> is false.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>model_rates</code> - the model used to calculate likelihoods</dd>
<dd><code>mapped_table</code> - profile table mapped to the model_rates' phylogeny leaf order</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="fromBundle(count.io.ModelBundle)">fromBundle</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType"><a href="MLPhylogeny.NearBestModels.html" title="class in count.model">MLPhylogeny.NearBestModels</a></span>&nbsp;<span class="memberName">fromBundle</span>&#8203;(<span class="arguments"><a href="../io/ModelBundle.html" title="class in count.io">ModelBundle</a>&nbsp;bundle)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="saveNearBestModels(java.lang.String,java.lang.String)">saveNearBestModels</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">saveNearBestModels</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;bundle_file,
<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;bundle_id)</span>
                         throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="loadNearBestModels(java.lang.String)">loadNearBestModels</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">loadNearBestModels</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;bundle_file)</span>
                         throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a>,
<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.xml/org/xml/sax/SAXException.html?is-external=true" title="class or interface in org.xml.sax" class="externalLink">SAXException</a>,
<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.xml/javax/xml/parsers/ParserConfigurationException.html?is-external=true" title="class or interface in javax.xml.parsers" class="externalLink">ParserConfigurationException</a></span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.xml/org/xml/sax/SAXException.html?is-external=true" title="class or interface in org.xml.sax" class="externalLink">SAXException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.xml/javax/xml/parsers/ParserConfigurationException.html?is-external=true" title="class or interface in javax.xml.parsers" class="externalLink">ParserConfigurationException</a></code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="debugScore(count.model.MLPhylogeny.CandidateMove,java.io.PrintStream,java.lang.String)">debugScore</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">debugScore</span>&#8203;(<span class="arguments"><a href="MLPhylogeny.CandidateMove.html" title="class in count.model">MLPhylogeny.CandidateMove</a>&nbsp;M,
<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/io/PrintStream.html?is-external=true" title="class or interface in java.io" class="externalLink">PrintStream</a>&nbsp;out,
<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;reason)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="debugScore(java.io.PrintStream)">debugScore</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">debugScore</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/io/PrintStream.html?is-external=true" title="class or interface in java.io" class="externalLink">PrintStream</a>&nbsp;out)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="main(java.lang.String[])">main</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">main</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>[]&nbsp;args)</span>
                 throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/Exception.html?is-external=true" title="class or interface in java.lang" class="externalLink">Exception</a></span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/lang/Exception.html?is-external=true" title="class or interface in java.lang" class="externalLink">Exception</a></code></dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../module-summary.html">Module</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/MLPhylogeny.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
</footer>
</body>
</html>
